<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Linux 组 raid 1</title>
      <link href="/2025/07/13/Linux-%E7%BB%84-raid-1/"/>
      <url>/2025/07/13/Linux-%E7%BB%84-raid-1/</url>
      
        <content type="html"><![CDATA[<h1 id="Linux-组-raid-1"><a href="#Linux-组-raid-1" class="headerlink" title="Linux 组 raid 1"></a>Linux 组 raid 1</h1><h2 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h2><ul><li><p>服务器环境</p><p>  Debian GNU&#x2F;Linux 12 (bookworm)</p></li></ul><p>前段时间在家翻箱子翻到了两块 14 年的机械硬盘，一块是西数的蓝盘，另一块是 seg 什么的，不知道是什么牌子，反正放着也是放着，思来想去，想用来当自己的储存服务器，储存一些需要持久化储存的数据，例如照片、视频或者一些比较重要的数据什么的</p><p>实话说这两块硬盘不是很敢用，什么时候突然暴毙就完蛋了，但是突然又想起了之前在微信公众号看到的一种技术方式——磁盘冗余阵列，根据各个 raid 等级可以用两个或多个硬盘组成不同的效果，可以让自己的数据储存的更放心一些，所以也就有了这篇文章</p><p>这篇文章我想记录一下组 raid 1 的过程以及踩坑记录，希望能不翻车。</p><h2 id="安装-mdadm"><a href="#安装-mdadm" class="headerlink" title="安装 mdadm"></a>安装 mdadm</h2><p>Mdadm 是管理 Linux 上软件 RAID 的实用程序。它在所有主要发行版中都可用。</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt-get update &amp;&amp; <span class="built_in">sudo</span> apt-get install mdadm</span><br></pre></td></tr></table></figure><p>首先看一下我的两个机械硬盘属于被识别为什么名字，其中 sdc 是我的两个机械硬盘，之前装飞牛 nas 遗留的 raid 0，还没有怎么处理它</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># lsblk</span></span><br><span class="line">NAME                                              MAJ:MIN RM   SIZE RO TYPE  MOUNTPOINTS</span><br><span class="line">sda                                                 8:0    0 931.5G  0 disk</span><br><span class="line">└─sda1                                              8:1    0 931.5G  0 part</span><br><span class="line">  └─md127                                           9:127  0   1.8T  0 raid0</span><br><span class="line">    └─trim_53fde9e3_abc8_4c19_9692_c236b5ce6dcf-0 254:2    0   1.8T  0 lvm</span><br><span class="line">sdb                                                 8:16   0 119.2G  0 disk</span><br><span class="line">├─sdb1                                              8:17   0   512M  0 part  /boot/efi</span><br><span class="line">├─sdb2                                              8:18   0   488M  0 part  /boot</span><br><span class="line">└─sdb3                                              8:19   0 118.3G  0 part</span><br><span class="line">  ├─Rubbish--computer--vg-root                    254:0    0     1T  0 lvm   /</span><br><span class="line">  └─Rubbish--computer--vg-swap_1                  254:1    0   980M  0 lvm   [SWAP]</span><br><span class="line">sdc                                                 8:32   0 931.5G  0 disk</span><br><span class="line">└─sdc1                                              8:33   0 931.5G  0 part</span><br><span class="line">  └─md127                                           9:127  0   1.8T  0 raid0</span><br><span class="line">    └─trim_53fde9e3_abc8_4c19_9692_c236b5ce6dcf-0 254:2    0   1.8T  0 lvm</span><br><span class="line">nvme0n1                                           259:0    0 931.5G  0 disk</span><br><span class="line">└─nvme0n1p1                                       259:1    0 931.5G  0 part</span><br><span class="line">  └─Rubbish--computer--vg-root                    254:0    0     1T  0 lvm   /</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="卸载原来的-raid-0"><a href="#卸载原来的-raid-0" class="headerlink" title="卸载原来的 raid 0"></a>卸载原来的 raid 0</h2><p>直接给 sda 和 sdc 重新分区就好了</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">fdisk /dev/sda</span><br><span class="line">// 按 n，一直回车，然后按 w 保存</span><br><span class="line">fdisk /dev/sdc</span><br><span class="line">// 同上</span><br></pre></td></tr></table></figure><p>操作完之后重启一下，输入 lsblk 就变成了这样</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@Rubbish-computer:~# lsblk</span><br><span class="line">NAME                             MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS</span><br><span class="line">sda                                8:0    0 931.5G  0 disk</span><br><span class="line">└─sda1                             8:1    0 931.5G  0 part</span><br><span class="line">sdb                                8:16   0 119.2G  0 disk</span><br><span class="line">├─sdb1                             8:17   0   512M  0 part /boot/efi</span><br><span class="line">├─sdb2                             8:18   0   488M  0 part /boot</span><br><span class="line">└─sdb3                             8:19   0 118.3G  0 part</span><br><span class="line">  ├─Rubbish--computer--vg-root   254:0    0     1T  0 lvm  /</span><br><span class="line">  └─Rubbish--computer--vg-swap_1 254:1    0   980M  0 lvm  [SWAP]</span><br><span class="line">sdc                                8:32   0 931.5G  0 disk</span><br><span class="line">└─sdc1                             8:33   0 931.5G  0 part</span><br><span class="line">nvme0n1                          259:0    0 931.5G  0 disk</span><br><span class="line">└─nvme0n1p1                      259:1    0 931.5G  0 part</span><br><span class="line">  └─Rubbish--computer--vg-root   254:0    0     1T  0 lvm  /</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="组-raid-1"><a href="#组-raid-1" class="headerlink" title="组 raid 1"></a>组 raid 1</h2><p>照着输命令，这个命令的意思是在 md1 上创建 raid1，然后选择硬盘</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mdadm --create --verbose /dev/md1 --level=1 --raid-devices=2 /dev/sda1 /dev/sdc1</span><br><span class="line">// 有选项就输 y</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@Rubbish-computer:~# lsblk</span><br><span class="line">NAME                             MAJ:MIN RM   SIZE RO TYPE  MOUNTPOINTS</span><br><span class="line">sda                                8:0    0 931.5G  0 disk</span><br><span class="line">└─sda1                             8:1    0 931.5G  0 part</span><br><span class="line">  └─md1                            9:1    0 931.4G  0 raid1</span><br><span class="line">sdb                                8:16   0 119.2G  0 disk</span><br><span class="line">├─sdb1                             8:17   0   512M  0 part  /boot/efi</span><br><span class="line">├─sdb2                             8:18   0   488M  0 part  /boot</span><br><span class="line">└─sdb3                             8:19   0 118.3G  0 part</span><br><span class="line">  ├─Rubbish--computer--vg-root   254:0    0     1T  0 lvm   /</span><br><span class="line">  └─Rubbish--computer--vg-swap_1 254:1    0   980M  0 lvm   [SWAP]</span><br><span class="line">sdc                                8:32   0 931.5G  0 disk</span><br><span class="line">└─sdc1                             8:33   0 931.5G  0 part</span><br><span class="line">  └─md1                            9:1    0 931.4G  0 raid1</span><br><span class="line">nvme0n1                          259:0    0 931.5G  0 disk</span><br><span class="line">└─nvme0n1p1                      259:1    0 931.5G  0 part</span><br><span class="line">  └─Rubbish--computer--vg-root   254:0    0     1T  0 lvm   /</span><br><span class="line">root@Rubbish-computer:~# fdisk /dev/m</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>给 md1 新建分区</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">fdisk /dev/md1</span><br><span class="line">// 依次输入: n -&gt; 回车 -&gt; 回车 -&gt; 回车  w</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@Rubbish-computer:~# lsblk</span><br><span class="line">NAME                             MAJ:MIN RM   SIZE RO TYPE  MOUNTPOINTS</span><br><span class="line">sda                                8:0    0 931.5G  0 disk</span><br><span class="line">└─sda1                             8:1    0 931.5G  0 part</span><br><span class="line">  └─md1                            9:1    0 931.4G  0 raid1</span><br><span class="line">    └─md1p1                      259:2    0 931.4G  0 part</span><br><span class="line">sdb                                8:16   0 119.2G  0 disk</span><br><span class="line">├─sdb1                             8:17   0   512M  0 part  /boot/efi</span><br><span class="line">├─sdb2                             8:18   0   488M  0 part  /boot</span><br><span class="line">└─sdb3                             8:19   0 118.3G  0 part</span><br><span class="line">  ├─Rubbish--computer--vg-root   254:0    0     1T  0 lvm   /</span><br><span class="line">  └─Rubbish--computer--vg-swap_1 254:1    0   980M  0 lvm   [SWAP]</span><br><span class="line">sdc                                8:32   0 931.5G  0 disk</span><br><span class="line">└─sdc1                             8:33   0 931.5G  0 part</span><br><span class="line">  └─md1                            9:1    0 931.4G  0 raid1</span><br><span class="line">    └─md1p1                      259:2    0 931.4G  0 part</span><br><span class="line">nvme0n1                          259:0    0 931.5G  0 disk</span><br><span class="line">└─nvme0n1p1                      259:1    0 931.5G  0 part</span><br><span class="line">  └─Rubbish--computer--vg-root   254:0    0     1T  0 lvm   /</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>格式化 md1p1，格式为 ext4</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"> mkfs.ext4 /dev/md1p1</span><br><span class="line"> <span class="built_in">mkdir</span> /mechanical_raid1</span><br><span class="line">mount /dev/md1p1 /mnt/mechanical_raid1/</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@Rubbish-computer:~# lsblk</span><br><span class="line">NAME                             MAJ:MIN RM   SIZE RO TYPE  MOUNTPOINTS</span><br><span class="line">sda                                8:0    0 931.5G  0 disk</span><br><span class="line">└─sda1                             8:1    0 931.5G  0 part</span><br><span class="line">  └─md1                            9:1    0 931.4G  0 raid1</span><br><span class="line">    └─md1p1                      259:2    0 931.4G  0 part  /mnt/mechanical_raid1</span><br><span class="line">sdb                                8:16   0 119.2G  0 disk</span><br><span class="line">├─sdb1                             8:17   0   512M  0 part  /boot/efi</span><br><span class="line">├─sdb2                             8:18   0   488M  0 part  /boot</span><br><span class="line">└─sdb3                             8:19   0 118.3G  0 part</span><br><span class="line">  ├─Rubbish--computer--vg-root   254:0    0     1T  0 lvm   /</span><br><span class="line">  └─Rubbish--computer--vg-swap_1 254:1    0   980M  0 lvm   [SWAP]</span><br><span class="line">sdc                                8:32   0 931.5G  0 disk</span><br><span class="line">└─sdc1                             8:33   0 931.5G  0 part</span><br><span class="line">  └─md1                            9:1    0 931.4G  0 raid1</span><br><span class="line">    └─md1p1                      259:2    0 931.4G  0 part  /mnt/mechanical_raid1</span><br><span class="line">nvme0n1                          259:0    0 931.5G  0 disk</span><br><span class="line">└─nvme0n1p1                      259:1    0 931.5G  0 part</span><br><span class="line">  └─Rubbish--computer--vg-root   254:0    0     1T  0 lvm   /</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="配置开机挂载"><a href="#配置开机挂载" class="headerlink" title="配置开机挂载"></a>配置开机挂载</h2><p>查找 md1p1 的 UUID</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@Rubbish-computer:~# blkid</span><br><span class="line">/dev/mapper/Rubbish--computer--vg-swap_1: UUID=<span class="string">&quot;311186db-54d9-4e03-93b7-b2fa17b058f2&quot;</span> TYPE=<span class="string">&quot;swap&quot;</span></span><br><span class="line">/dev/nvme0n1p1: UUID=<span class="string">&quot;dm0hnz-6587-hDDp-kYup-OmtG-Mhp3-U23iZd&quot;</span> TYPE=<span class="string">&quot;LVM2_member&quot;</span> PARTUUID=<span class="string">&quot;f482e853-4f6b-3f48-9194-b574a2f2c6bd&quot;</span></span><br><span class="line">/dev/sdb2: UUID=<span class="string">&quot;c3c94fc5-5d17-44b7-ae10-122a34d801a3&quot;</span> BLOCK_SIZE=<span class="string">&quot;1024&quot;</span> TYPE=<span class="string">&quot;ext2&quot;</span> PARTUUID=<span class="string">&quot;5e0ac597-ccdd-496c-a33c-7b8f149fb276&quot;</span></span><br><span class="line">/dev/sdb3: UUID=<span class="string">&quot;90TQiF-6KDn-p4Eq-ZSXA-x4oA-Xq7Q-2SJF7t&quot;</span> TYPE=<span class="string">&quot;LVM2_member&quot;</span> PARTUUID=<span class="string">&quot;acc67b2c-f279-47d0-868c-89266ec5e3f1&quot;</span></span><br><span class="line">/dev/sdb1: UUID=<span class="string">&quot;2D83-6E26&quot;</span> BLOCK_SIZE=<span class="string">&quot;512&quot;</span> TYPE=<span class="string">&quot;vfat&quot;</span> PARTLABEL=<span class="string">&quot;EFI System Partition&quot;</span> PARTUUID=<span class="string">&quot;e0896f57-66c5-48ad-b51e-02fef04220f5&quot;</span></span><br><span class="line">/dev/mapper/Rubbish--computer--vg-root: UUID=<span class="string">&quot;91903da8-e448-4de6-abcf-2cc73d9ba92b&quot;</span> BLOCK_SIZE=<span class="string">&quot;4096&quot;</span> TYPE=<span class="string">&quot;ext4&quot;</span></span><br><span class="line">/dev/sdc1: UUID=<span class="string">&quot;23ec7260-b69e-aa05-96f8-f8393bee6722&quot;</span> UUID_SUB=<span class="string">&quot;64da14d7-8eb0-086a-eb46-a8948a5279cb&quot;</span> LABEL=<span class="string">&quot;Rubbish-computer:1&quot;</span> TYPE=<span class="string">&quot;linux_raid_member&quot;</span> PARTUUID=<span class="string">&quot;578b58f0-9d0c-1f4c-8dec-7f66b139dbe7&quot;</span></span><br><span class="line">/dev/sda1: UUID=<span class="string">&quot;23ec7260-b69e-aa05-96f8-f8393bee6722&quot;</span> UUID_SUB=<span class="string">&quot;3aa7b1db-83d0-81b2-a348-9de1b6035f40&quot;</span> LABEL=<span class="string">&quot;Rubbish-computer:1&quot;</span> TYPE=<span class="string">&quot;linux_raid_member&quot;</span> PARTUUID=<span class="string">&quot;71010802-ffff-df40-9b00-c0fdfb035a22&quot;</span></span><br><span class="line">/dev/md1p1: UUID=<span class="string">&quot;a637a848-0aec-4423-808c-fae7f5bb022a&quot;</span> BLOCK_SIZE=<span class="string">&quot;4096&quot;</span> TYPE=<span class="string">&quot;ext4&quot;</span> PARTUUID=<span class="string">&quot;e2da37e8-01&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>修改配置文件，a637a848-0aec-4423-808c-fae7f5bb022a 是md1p1 的UUID</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/fstab</span><br><span class="line"></span><br><span class="line">// 末尾添加下面这行，这个条目告诉系统在启动时将 UUID 为 </span><br><span class="line">// 5607a174-cfb3-476f-b509-a0e2e5f9654b 的 ext4 文件系统挂载到 /mnt/mechanical_raid1目录，</span><br><span class="line">// 使用默认挂载选项，不需要备份，并在启动时进行文件系统检查（在根文件系统之后）。</span><br><span class="line">UUID=a637a848-0aec-4423-808c-fae7f5bb022a /mnt/mechanical_raid1 ext4 defaults 0 2</span><br></pre></td></tr></table></figure><h2 id="拓展"><a href="#拓展" class="headerlink" title="拓展"></a>拓展</h2><p>为什么 916G 的总可用空间，只有 870G  可用？</p><p>因为默认情况下 ext4 保留约5%的空间给 root 用户(防止普通用户占满内存导致系统问题)，解决方式：将5%的保留空间调整到1%</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> tune2fs -m 1 /dev/md127p1  <span class="comment"># 将保留空间从 5% 改为 1%</span></span><br><span class="line"><span class="built_in">sudo</span> mount -o remount /mnt/mechanical_raid1  <span class="comment"># 重新挂载生效</span></span><br><span class="line"><span class="built_in">df</span> -h  <span class="comment"># 检查可用空间是否增加</span></span><br></pre></td></tr></table></figure><p>调整后可用空间来到了 907G</p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
          <category> raid </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> raid </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>操作系统安全配置(旧)</title>
      <link href="/2021/08/01/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E9%85%8D%E7%BD%AE-%E6%97%A7/"/>
      <url>/2021/08/01/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E9%85%8D%E7%BD%AE-%E6%97%A7/</url>
      
        <content type="html"><![CDATA[<h1 id="Windows篇"><a href="#Windows篇" class="headerlink" title="Windows篇"></a>Windows篇</h1><h2 id="设置密码策略必须同时满足大小写字母、数字、特殊字符，最小密码长度不少于8个字符，密码最长使用期限为15天"><a href="#设置密码策略必须同时满足大小写字母、数字、特殊字符，最小密码长度不少于8个字符，密码最长使用期限为15天" class="headerlink" title="设置密码策略必须同时满足大小写字母、数字、特殊字符，最小密码长度不少于8个字符，密码最长使用期限为15天"></a>设置密码策略必须同时满足大小写字母、数字、特殊字符，最小密码长度不少于8个字符，密码最长使用期限为15天</h2><ol><li>CMD输入secpol.msc进入本地策略安全</li><li>账户策略&gt;&gt;密码策略</li></ol><p><img src="https://bu.dusays.com/2025/11/03/6908a93c9325e.png" alt="windows1"></p><h2 id="在用户登录系统时，应该有”For-unauthorized-users-only”提示信息"><a href="#在用户登录系统时，应该有”For-unauthorized-users-only”提示信息" class="headerlink" title="在用户登录系统时，应该有”For unauthorized users only”提示信息"></a>在用户登录系统时，应该有”For unauthorized users only”提示信息</h2><p>本地安全策略&gt;&gt;本地策略&gt;&gt;安全选项&gt;&gt;交互式登录</p><p><img src="https://bu.dusays.com/2025/11/03/6908aa0e0beac.webp" alt="windows2"></p><h2 id="一分钟内仅允许5次登录失败的尝试，超过5次，登录帐号锁定1分钟"><a href="#一分钟内仅允许5次登录失败的尝试，超过5次，登录帐号锁定1分钟" class="headerlink" title="一分钟内仅允许5次登录失败的尝试，超过5次，登录帐号锁定1分钟"></a>一分钟内仅允许5次登录失败的尝试，超过5次，登录帐号锁定1分钟</h2><p>本地安全策略&gt;&gt;本地策略&gt;&gt;账户策略&gt;&gt;账户锁定策略</p><p><img src="https://bu.dusays.com/2025/11/03/6908a8f46418b.png" alt="windows3"></p><h2 id="设置远程桌面用户非活动会话连接超时应小于等于5分钟"><a href="#设置远程桌面用户非活动会话连接超时应小于等于5分钟" class="headerlink" title="设置远程桌面用户非活动会话连接超时应小于等于5分钟"></a>设置远程桌面用户非活动会话连接超时应小于等于5分钟</h2><p>该题有两种解法：</p><p><strong>解法一：</strong></p><ol><li>gpedit.msc进入组策略编辑器</li><li>计算机配置&gt;&gt;管理模板&gt;&gt;Windows组件&gt;&gt;远程桌面服务&gt;&gt;远程桌面会话主机&gt;&gt;会话时间限制</li></ol><p><strong>解法二：</strong><br>CMD输入tscc.msc进入远程会话主机配置&gt;&gt;RD会话主机配置&gt;&gt;RDP-Tcp属性&gt;&gt;会话，结束已断开的会话—&gt;5分钟，空闲会话限制—&gt;5分钟</p><blockquote><p><strong>注意</strong>，优先级：本地组策略编辑器的设置 &gt;(大于) 远程桌面会话主机配置的设置，本地组策略编辑器中的优先级：计算机配置 &gt;(大于) 用户配置。解法二在Windows server2012及以上版本不适用。</p></blockquote><p><img src="https://bu.dusays.com/2025/11/03/6908aa680bc37.png" alt="windows11"></p><p><img src="https://bu.dusays.com/2025/11/03/6908a8f37d327.png" alt="windows4"></p><h2 id="仅允许超级管理员账号关闭系统"><a href="#仅允许超级管理员账号关闭系统" class="headerlink" title="仅允许超级管理员账号关闭系统"></a>仅允许超级管理员账号关闭系统</h2><p>secpol.msc进入本地策略安全，本地策略&gt;&gt;用户权限分配&gt;&gt;关闭系统</p><p><img src="https://bu.dusays.com/2025/11/03/6908a8f1a204e.png" alt="windows6"></p><h2 id="开启IIS的日志审计记录，日志文件保存格式为W3C-只记录日期、时间、客户端IP地址、用户名、服务器端口、方法"><a href="#开启IIS的日志审计记录，日志文件保存格式为W3C-只记录日期、时间、客户端IP地址、用户名、服务器端口、方法" class="headerlink" title="开启IIS的日志审计记录，日志文件保存格式为W3C,只记录日期、时间、客户端IP地址、用户名、服务器端口、方法"></a>开启IIS的日志审计记录，日志文件保存格式为W3C,只记录日期、时间、客户端IP地址、用户名、服务器端口、方法</h2><p>进入IIS管理器，网站&gt;&gt;日志。格式&gt;w3c，选择字段&gt;&gt;看题目要求</p><p><img src="https://bu.dusays.com/2025/11/03/6908a8f0c5be6.png" alt="windows7"></p><h2 id="设置网站的最大并发连接数为1000，网站连接超时为60s"><a href="#设置网站的最大并发连接数为1000，网站连接超时为60s" class="headerlink" title="设置网站的最大并发连接数为1000，网站连接超时为60s"></a>设置网站的最大并发连接数为1000，网站连接超时为60s</h2><p>IIS管理器&gt;&gt;网站&gt;&gt;操作&gt;&gt;限制</p><p><img src="https://bu.dusays.com/2025/11/03/6908a8efd1b56.png" alt="windows8"></p><h2 id="禁用IIS内核缓存，避免对方利用ms15-034漏洞进行DOS攻击，出现蓝屏的现象"><a href="#禁用IIS内核缓存，避免对方利用ms15-034漏洞进行DOS攻击，出现蓝屏的现象" class="headerlink" title="禁用IIS内核缓存，避免对方利用ms15_034漏洞进行DOS攻击，出现蓝屏的现象"></a>禁用IIS内核缓存，避免对方利用ms15_034漏洞进行DOS攻击，出现蓝屏的现象</h2><p>IIS管理器&gt;&gt;网站&gt;&gt;输出缓存&gt;&gt;编辑功能设置</p><p><img src="https://bu.dusays.com/2025/11/03/6908aa9b85c50.png" alt="windows9"></p><h2 id="设置user1用户只能在上班时间（周一至周五的9-00-18-00）可以登录"><a href="#设置user1用户只能在上班时间（周一至周五的9-00-18-00）可以登录" class="headerlink" title="设置user1用户只能在上班时间（周一至周五的9:00~18:00）可以登录"></a>设置user1用户只能在上班时间（周一至周五的9:00~18:00）可以登录</h2><p>添加并配置域服务，创建域，在Active Directory管理中心配置user1登录时间</p><p><img src="https://bu.dusays.com/2025/11/03/6908aaa875b9e.png" alt="windows10"></p><h2 id="拓展"><a href="#拓展" class="headerlink" title="拓展"></a>拓展</h2><blockquote><ul><li>gpedit.msc &gt;&gt; 本地组策略编辑器</li><li>secpol.msc &gt;&gt; 本地安全策略</li><li>msconfig &gt;&gt; 系统配置</li><li>Tscc.msc &gt;&gt; 远程会话主机配置(Windows server2012版本或以上已取消此功能)</li></ul></blockquote><h1 id="Linux篇"><a href="#Linux篇" class="headerlink" title="Linux篇"></a>Linux篇</h1><h2 id="设置最小密码长度不少于8个字符，密码最长使用期限为15天"><a href="#设置最小密码长度不少于8个字符，密码最长使用期限为15天" class="headerlink" title="设置最小密码长度不少于8个字符，密码最长使用期限为15天"></a>设置最小密码长度不少于8个字符，密码最长使用期限为15天</h2><p>编辑配置文件login.defs</p><p><img src="https://bu.dusays.com/2025/11/03/6908a933a4b1f.png" alt="linux1"></p><h2 id="设置在用户登录系统时，会有”For-unauthorized-users-only”提示信息"><a href="#设置在用户登录系统时，会有”For-unauthorized-users-only”提示信息" class="headerlink" title="设置在用户登录系统时，会有”For unauthorized users only”提示信息"></a>设置在用户登录系统时，会有”For unauthorized users only”提示信息</h2><p>编辑配置文件issue，在新一行写入”For unauthorized users only”</p><p><img src="https://bu.dusays.com/2025/11/03/6908a9347fd9f.png" alt="linux2"></p><h2 id="拓展-1"><a href="#拓展-1" class="headerlink" title="拓展"></a>拓展</h2><blockquote><p>配置文件issue中的提示为本地登录，且是在登录前出现</p><p><img src="https://bu.dusays.com/2025/11/03/6908aaecbdfbc.png" alt="issue"></p><p>配置文件 motd(系统不自带，需自行在etc下创建)中的提示为本地登录，且是在登录成功后出现</p><p><img src="https://bu.dusays.com/2025/11/03/6908a93aa4cb0.png" alt="motd"></p><p>实现 ssh 登录提示语，需要在ssh的配置文件的 banner 中添加提示语文件路径才可以实现</p><p><strong>提示语文件需自行创建，且提示语是在输入登录账号后呈现</strong></p><p><img src="https://bu.dusays.com/2025/11/03/6908a93b845ab.png" alt="sshd"></p><p>效果图：<br><img src="https://bu.dusays.com/2025/11/03/6908ab19a490c.png" alt="banner"></p></blockquote><h2 id="设置root用户的计划任务。每天早上7-50自动开启vsftpd服务，22点50时关闭；每周六的7-30时，重新启动vsftpd服务"><a href="#设置root用户的计划任务。每天早上7-50自动开启vsftpd服务，22点50时关闭；每周六的7-30时，重新启动vsftpd服务" class="headerlink" title="设置root用户的计划任务。每天早上7:50自动开启vsftpd服务，22点50时关闭；每周六的7:30时，重新启动vsftpd服务"></a>设置root用户的计划任务。每天早上7:50自动开启vsftpd服务，22点50时关闭；每周六的7:30时，重新启动vsftpd服务</h2><p>输入crontab -e，按照”分钟 小时 天 月 星期 你要执行的命令的”的格式来定时任务</p><p><img src="https://bu.dusays.com/2025/11/03/6908a9362be6d.png" alt="linux4"></p><h2 id="禁止匿名用户登录vsftpd服务"><a href="#禁止匿名用户登录vsftpd服务" class="headerlink" title="禁止匿名用户登录vsftpd服务"></a>禁止匿名用户登录vsftpd服务</h2><p><img src="https://bu.dusays.com/2025/11/03/6908a9371aad6.png" alt="linux5"></p><h2 id="限制客户端连接vsftpd服务时，同一个IP最多只能打开两个连接"><a href="#限制客户端连接vsftpd服务时，同一个IP最多只能打开两个连接" class="headerlink" title="限制客户端连接vsftpd服务时，同一个IP最多只能打开两个连接"></a>限制客户端连接vsftpd服务时，同一个IP最多只能打开两个连接</h2><p>在vsftp配置文件中加入以下这句话</p><p><img src="https://bu.dusays.com/2025/11/03/6908a9355a68d.png" alt="linux3"></p><h2 id="禁止root用户通过SSH远程登录"><a href="#禁止root用户通过SSH远程登录" class="headerlink" title="禁止root用户通过SSH远程登录"></a>禁止root用户通过SSH远程登录</h2><p>修改ssh配置文件</p><p><img src="https://bu.dusays.com/2025/11/03/6908a938d1678.png" alt="linux7"></p><h2 id="禁止mysql服务以管理员权限的账号运行"><a href="#禁止mysql服务以管理员权限的账号运行" class="headerlink" title="禁止mysql服务以管理员权限的账号运行"></a>禁止mysql服务以管理员权限的账号运行</h2><p>在my.cnf修改以下内容，或者在mysql数据库输入命令”revoke all on <em>.</em> from ‘root‘@’localhost’;”</p><p><img src="https://bu.dusays.com/2025/11/03/6908a939bb002.png" alt="linux8"></p>]]></content>
      
      
      <categories>
          
          <category> 网络安全试题 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网络安全 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ftp的搭建与说明(旧).md</title>
      <link href="/2021/07/05/ftp%E7%9A%84%E6%90%AD%E5%BB%BA%E4%B8%8E%E8%AF%B4%E6%98%8E-%E6%97%A7-md/"/>
      <url>/2021/07/05/ftp%E7%9A%84%E6%90%AD%E5%BB%BA%E4%B8%8E%E8%AF%B4%E6%98%8E-%E6%97%A7-md/</url>
      
        <content type="html"><![CDATA[<h2 id="关于ftp-在Linux中为vsftpd"><a href="#关于ftp-在Linux中为vsftpd" class="headerlink" title="关于ftp(在Linux中为vsftpd)"></a>关于ftp(在Linux中为vsftpd)</h2><p>文件传输协议（File Transfer Protocol，FTP）是用于在网络上进行文件传输的一套标准协议，它工作在 OSI 模型的第七层， TCP 模型的第四层， 即应用层， 使用 TCP 传输而不是 UDP， 客户在和服务器建立连接前要经过一个“三次握手”的过程， 保证客户与服务器之间的连接是可靠的， 而且是面向连接， 为数据传输提供可靠保证。</p><h2 id="客户端安装ftp"><a href="#客户端安装ftp" class="headerlink" title="客户端安装ftp"></a>客户端安装ftp</h2><blockquote><p>演示环境：Centos 6.8</p></blockquote><ol><li>yum install vsftp -y #从yum源下载vsftp</li><li>vi &#x2F;etc&#x2F;vsftpd&#x2F;vsftpd.conf #修改vsftp配置文件</li><li>在配置文件中将anonymous_enable&#x3D;NO改为YES</li><li>service vsftpd start #开启vsftp</li><li>service iptables stop #关闭防火墙</li><li>完成，你可以访问别的主机的 vsftp 了</li></ol><h2 id="服务器安装-ftp"><a href="#服务器安装-ftp" class="headerlink" title="服务器安装 ftp"></a>服务器安装 ftp</h2><blockquote><p>演示环境：Centos7.4</p></blockquote><p>按照上述客户端安装 ftp 的步骤来一遍</p><p>要注意，按上述步骤在局域网内是没有问题的，但是在云服务器上就有坑要填。因为云服务器有一个安全组的机制，然后从这个突破口去寻找解决方案。首先将局域网的配置步骤照搬到服务器上，启动发现无论是浏览器还是filezilla客户端都访问不了。在解决这个问题之前要了解ftp的两个工作模式：Port和Pasv。FTP连接一般会有两个连接，也就是会需要用到两个端口。一个服务器与客户端跟进行命令交互的，一个是进行数据传送的。那两种工作模式跟两个连接是怎么搭配起来工作的呢？</p><p><strong>假设客户端为C，服务器端为S(以下简称C和S)：</strong></p><ul><li>Port模式：当客户端C和服务端S连接起来后，C会发送一条命令告诉S：“我在本地打开了一个端口N等你进行数据连接”，当S收到这个Port命令后就会向C打开的那个端口N进行数据连接。S主动向C的某个端口进行数据连接，此乃主动模式</li><li>Pasv模式：当客户端C和服务端S连接起来后，S会发送一条命令告诉C：“我再本地打开了一个端口M你来连接我吧”，当C收到这个消息后就会向S的M端口发起数据连接。S打开端口被C主动连接，此乃被动模式</li></ul><p>那我们应该使用哪种工作模式呢？答案是被动（默认工作模式就是被动）。为什么？很简单，你是在局域网内，你可以连接到云服务器的某个端口（前提是这个端口放开了），但是云服务器连接不到你的，因为云服务器有公网IP。</p><p>无论是哪一种工作模式，首先在建立控制连接时候操作是一样的，都是由客户端（首先随机选取一个大于1024以上的端口）和FTP服务器的控制端口21建立连接，并通过该连接传输操作指令。</p><p>那么，两种工作模式的区别是什么呢？</p><p>在于使用数据传输端口（ftp-data）方式。port mode由FTP服务器指定数据传输所使用的端口，默认值为20。pasv mode由FTP客户端决定数据传输端口，客户端向服务端发出连接请求包含了数据传输端口</p><p>服务器安装ftp其实与客户端安装ftp没太大差异，主要区别在服务器要多加两个配置,在 vftpd.conf 中增加以下内容：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pasv_enable=YES</span><br><span class="line">pasv_min_port=30000</span><br><span class="line">pasv_max_port=50000</span><br></pre></td></tr></table></figure><p>最后在服务器的防火墙中放行30000-50000范围端口就欧克了</p><h2 id="附：vsftp配置文件说明"><a href="#附：vsftp配置文件说明" class="headerlink" title="附：vsftp配置文件说明"></a>附：vsftp配置文件说明</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 允许匿名访问</span><br><span class="line">anonymous_enable=YES</span><br><span class="line"># 不允许本地用户，如root用户登陆。默认允许</span><br><span class="line">local_enable=NO</span><br><span class="line">#设置本地用户登录所在的目录。默认配置文件中没有该配置项，本地用户登录FTP服务器后所在的目录为所登录用户的主目录，如：对于root用户，则为/root目录</span><br><span class="line"># local_root=/home/ftpuser</span><br><span class="line"># 本地用户上传文件权限</span><br><span class="line">local_umask=022</span><br><span class="line"># 匿名用户上传文件权限</span><br><span class="line">anon_umask=022</span><br><span class="line"># 允许写入操作，否则不能上传文件</span><br><span class="line">write_enable=YES</span><br><span class="line"># 允许匿名用户上传文件，需要配合write_enable=yes</span><br><span class="line">anon_upload_enable=YES</span><br><span class="line"># 控制匿名用户对文件和文件夹的删除和重命名(自己添加，没有该配置)</span><br><span class="line">anon_other_write_enable=YES</span><br><span class="line"># 允许匿名用户创建目录</span><br><span class="line">anon_mkdir_write_enable=YES</span><br><span class="line"># ftp工具连接成功提示</span><br><span class="line">ftpd_banner=Welcome to blah FTP service.</span><br><span class="line"># 所有用户均不能切换到上级目录</span><br><span class="line">chroot_local_user=YES</span><br><span class="line"># 是否启动限制用户的名单。YES为启用，NO禁用。默认禁用</span><br><span class="line">chroot_list_enable=NO</span><br><span class="line"># /etc/vsftpd/user_list文件不生效</span><br><span class="line">userlist_enable=NO</span><br><span class="line">#坑，添加以下配置。不添加此项，文件无法上传。报错：550 Permission denied。新版本vsftpd加入了安全需求，切根不允许写，要添加这个配置并设置为YES才可以</span><br><span class="line">allow_writeable_chroot=YES</span><br><span class="line">#匿名用户的根目录。这个非常重要</span><br><span class="line">anon_root=/usr/local/ftpdir</span><br><span class="line">#匿名用户不要密码就靠这个</span><br><span class="line">no_anon_password=YES</span><br><span class="line"># 匿名登录后的使用者</span><br><span class="line">ftp_username=ftpuser</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 操作系统服务配置 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ftp </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
